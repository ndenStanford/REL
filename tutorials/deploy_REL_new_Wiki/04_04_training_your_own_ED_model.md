# Training your own Entity Disambiguation model
For our final tutorial we will train our own Entity Disambiguation model. The first step, as always, is to import
the necessary packages and to define the `wiki_version`.

```python
from REL.training_datasets import TrainingEvaluationDatasets
from REL.entity_disambiguation import EntityDisambiguation

wiki_version = "wiki_2019"
```

Our second step is loading our training and evaluation datasets that can be found in our `generated` folder. These
datasets are provided by us, but can also be generated by the user in previous steps.

```python
datasets = TrainingEvaluationDatasets(base_url, wiki_version).load()
```


Our third step consists of defining the config dictionary that serves as an input to the model. If the mode is set 
to `eval` then the model will evaluate the given datasets given that the model exists (else it will throw an error). The 
mode should be set to `train` if the user wishes to train a new model and save it in the given `model_path`.

```python
config = {
    "mode": "train",
    "model_path": "{}/{}/generated/model".format(
        base_url, wiki_version
    ),
}
model = EntityDisambiguation(base_url, wiki_version, config)
```

Our fourth step consists of training or evaluating the model. This is dependent on the `mode` that was chosen previously,

```python
# 3. Train or evaluate model
if config["mode"] == "train":
    model.train(
        datasets["aida_train"], {k: v for k, v in datasets.items() if k != "aida_train"}
    )
else:
    model.evaluate({k: v for k, v in datasets.items() if "train" not in k})
```

Now that we have obtained our model, we want to express how confident we are in our prediction.
By default this is not integrated in our model, but we implemented an additional step, where we use Logistic Regression
to obtain confidence scores. However, to obtain such scores, we first need to train the model. This can be done by
running the code below.

```python
# 3. Train and predict using LR

model_path_lr = "{}/{}/generated/".format(base_url, wiki_version)

model.train_LR(
    datasets,
    model_path_lr
)
```